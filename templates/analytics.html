<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Page Title</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        .tabs {
            display: flex;
            list-style-type: none;
            margin: 0;
            padding: 0;
            background-color: #f1f1f1;
        }

        .tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            border: 1px solid #ccc;
        }

        .tab:hover {
            background-color: #ddd;
        }
        .logo {
            max-width: 100px;
            height: 100px;
        }
        .header {
            text-align: center;
            font-size: 24px;
        }
        .header-container {
            border: 2px solid #000;
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 98%;
        }
 
        #AnalyticsContent,
        #PredictionsContent,
        #filters {
            display: none;
        }

        #iframe {
            display: none;
        }
    </style>
</head>
<body>
    <div class="header-container">
        <div class="logo">
            <img src="https://www.nus.edu.sg/images/default-source/identity-images/NUS_logo_full-horizontal.jpg" alt="NUS Logo" style="height: 100px;">
        </div>
        <div class="header">
            <h1>NUSecure</h1>
        </div>
        <div class="analytics-team">
            <h1>Analytics Team</h1>
        </div>
    </div>

    <div class="container">
        <div class="performance-container">
            <h2 style="font-size: 38px;">Data Analytics Dashboard</h2>
            <ul class="tabs">
                <li class="tab" onclick="showContent('Analytics')">Analytics</li>
                <li class="tab" onclick="showContent('Predictions')">Predictions</li>
            </ul>

            <div class="content" id="AnalyticsContent">
                <h2>Analytics Page</h2>
                <div class="filters">
                    <form>
                        <label for="Location">Location:</label>
                        <select id="Location">
                            <option value="Canteen">Canteen</option>
                            <option value="Faculty">Faculty</option>
                            <option value="Halls">Halls</option>
                            <option value="Libraries">Libraries</option>
                        </select>
                        <br>
                        <label for="Crimes">Incident Types:</label>
                        <br>
                        <input type="checkbox" id="LostFound" name="LostFound" value="Lost and Found" checked>
                        <label for="LostFound">Lost and Found</label>
                        <br>
                        <input type="checkbox" id="StolenItems" name="StolenItems" value="Stolen Items">
                        <label for="StolenItems">Stolen Items</label>
                        <br>
                        <input type="checkbox" id="DamagedProperties" name="DamagedProperties" value="Damaged Properties">
                        <label for="DamagedProperties">Damaged Properties</label>
                        <br>
                        <input type="checkbox" id="SexualIncidents" name="SexualIncidents" value="Sexual Incidents">
                        <label for="SexualIncidents">Sexual Incidents</label>
                        <br>
                        <input type="checkbox" id="EmergencyIncidents" name="EmergencyIncidents" value="Emergency Incidents">
                        <label for="EmergencyIncidents">Emergency Incidents</label>
                        <br>
                        <label for="FromDate">From Date:</label>
                        <input type="date" id="FromDate">
                        <br>
                        <label for="ToDate">To Date:</label>
                        <input type="date" id="ToDate">
                    </form>
                </div>
                <div class="prediction-actions">
                    <button onclick="trainAllModels()">Train All Models</button>
                    <button onclick="forecastAll()">Forecast All</button>
                    <button onclick="getForecastPlot(['LostFound', 'StolenItems', 'DamagedProperties', 'SexualIncidents', 'EmergencyIncidents'])">Get Forecast Plot</button>
                    <button onclick="GeneratePlot()">Generate Plot</button>
                </div>
                <div class="chart-container">
                    <div id="chart1" class="chart"></div>
                    <div id="chart2" class="chart"></div>
                    <div id="chart3" class="chart"></div>
                </div>
                <div class="content">
                    <h2>Analytics Heatmap</h2>
                    <div class="heatmap-container" style="border: 1px solid #ccc; padding: 10px;">
                        <iframe id="map" src="{{ url_for('static', filename='/heatmap.html') }}" width="80%" height="500"></iframe>
                    </div>
                </div>
            </div>

            <div class="content" id="PredictionsContent">
                <h2>Predictions Page</h2>
                <div class="prediction-actions">
                    <button onclick="trainAllModels()">Train All Models</button>
                    <button onclick="forecastAll()">Forecast All</button>
                </div>
                <br>
                <div class="analytics-filters">
                    <label for="Location">Location:</label>
                        <select id="Location">
                            <option value="LostFound">Lost and Found</option>
                            <option value="StolenItems">Stolen Items</option>
                            <option value="DamagedProperties">Damaged Properties</option>
                            <option value="SexualIncidents">Sexual Incidents</option>
                            <option value="EmergencyIncidents">Emergency Incidents</option>
                        </select>

                    <label for="DayInput">Day:</label>
                    <input type="text" id="DayInput">
            
                    <label for="HourInput">Hour:</label>
                    <input type="text" id="HourInput">
            
                    <button onclick="getRankPriority()">Get Rank Priority</button>
                </div>
                <br>
                <div class="filters">
                    <form>
                        <label for="Location">Location:</label>
                        <select id="Location">
                            <option value="LostFound">Lost and Found</option>
                            <option value="StolenItems">Stolen Items</option>
                            <option value="DamagedProperties">Damaged Properties</option>
                            <option value="SexualIncidents">Sexual Incidents</option>
                            <option value="EmergencyIncidents">Emergency Incidents</option>
                        </select>
                        <br>
                    </form>
                </div>
                <br>
                <div id="forecastPlotContainer"></div>
                    <button onclick="getForecastPlot(['LostFound', 'StolenItems', 'DamagedProperties', 'SexualIncidents', 'EmergencyIncidents'])">Get Forecast Plot</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script>
        function showContent(tabName) {
            var i;
            var contents = document.getElementsByClassName("content");
            for (i = 0; i < contents.length; i++) {
                contents[i].style.display = "none";
            }

            document.getElementById(tabName + "Content").style.display = "block";
        }

        function showContent(tabName) {
            if (tabName === 'Analytics') {
                document.getElementById('AnalyticsContent').style.display = 'block';
                document.getElementById('PredictionsContent').style.display = 'none';
            } else if (tabName === 'Predictions') {
                document.getElementById('AnalyticsContent').style.display = 'none';
                document.getElementById('PredictionsContent').style.display = 'block';
            }
        }

        function trainAllModels() {
            fetch('/train_all')
                .then(response => response.json())
                .then(data => {
                    alert(data.message);
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }

        function forecastAll() {
            fetch('/forecast_all')
                .then(response => response.json())
                .then(data => {
                    alert(data.message);
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }

        function getForecastPlot(incidentType) {
            fetch(`/get_forecast_plot?incident_type=${incidentType}`)
                .then(response => {
                    if (response.ok) {
                        // Assuming the response is HTML, you can open it in a new tab
                        return response.text();
                    } else {
                        throw new Error('Failed to get forecast plot');
                    }
                })
                .then(html => {
                    // Open the forecast plot in a new tab
                    const newTab = window.open();
                    newTab.document.write(html);
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }

        function getRankPriority() {
            // Assuming you have location, day, and hour from your filters
            const location = document.getElementById('Location').value;
            const day = document.getElementById('Day').value;
            const hour = document.getElementById('Hour').value;

            // Make a fetch request to the rank_priority endpoint
            fetch(`/rank_priority?location=${location}&day=${day}&hour=${hour}`)
                .then(response => {
                    if (response.ok) {
                        // Assuming the response is JSON, you can handle it accordingly
                        return response.json();
                    } else {
                        throw new Error('Failed to get rank priority');
                    }
                })
                .then(data => {
                    // Handle the data from the response
                    console.log(data);
                    // Update your HTML with the data, or perform any other actions
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }
    </script>
</body>
</html>
